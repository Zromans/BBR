<!DOCTYPE html>
<html>
<head>
    <title>BBR Home</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function() {
            $("#scrape-button").click(function() {
                $(this).prop('disabled', true);
                $(this).text('Scraping...');
                $.ajax({
                    url: "{% url 'start_scrape' %}",
                    method: 'POST',
                    success: function(blob, status, xhr) {
                        var filename = "";
                        var disposition = xhr.getResponseHeader('Content-Disposition');
                        if (disposition && disposition.indexOf('attachment') !== -1) {
                            var filenameRegex = /filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/;
                            var matches = filenameRegex.exec(disposition);
                            if (matches != null && matches[1]) filename = matches[1].replace(/['"]/g, '');
                        }
                        var a = document.createElement('a');
                        var url = window.URL.createObjectURL(blob);
                        a.href = url;
                        a.download = filename;
                        document.body.append(a);
                        a.click();
                        window.URL.revokeObjectURL(url);
                        $("#scrape-button").prop('disabled', false);
                        $("#scrape-button").text('Start Scrape');
                    },
                    error: function(xhr, status, error) {
                        alert("An error occurred: " + error);
                        $("#scrape-button").prop('disabled', false);
                        $("#scrape-button").text('Start Scrape');
                    }
                });
            });
        });
    </script>
</head>
<body>
    <h1>Welcome to BBR</h1>
    
    <button id="scrape-button">Start Scrape</button>

    <!-- Your existing content here -->

</body>
</html>